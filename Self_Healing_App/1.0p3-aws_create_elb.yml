---
- name: Create new EC2 ELB
  hosts: localhost
  gather_facts: false
  connection: local

  vars:
    elb_name: "{{ student }}-elb"

  tasks:
     - name: Provision application load balancer
       ec2_elb_lb:
         name: "{{ elb_name }}"
         state: present
         region: us-west-1
         validate_certs: no
         # subnets:
         #   - subnet-23ec8c78
         zones:
           - us-west-1a
           - us-west-1c
         listeners:
           - protocol: http # options are http, https, ssl, tcp
             load_balancer_port: 80
             instance_port: 80
       register: ec2_elb

     - name: Dump ELB IP
       debug: msg="elb facts are {{ ec2_elb.results }}"
